<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}" data-theme="dark">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% seo %}
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    <script>
      (function() {
        const storedTheme = localStorage.getItem('theme');
        if (storedTheme) {
          document.documentElement.setAttribute('data-theme', storedTheme);
        }
      })();
    </script>
    {% include head-custom.html %}
  </head>
  <body>
    <div class="site-shell">
      <header class="site-header">
        <div class="container">
          <a class="brand" href="{{ "/" | absolute_url }}">
            {% if site.logo %}
              <span class="brand-avatar">
                <img src="{{ site.logo | relative_url }}" alt="{{ site.title }} logo">
              </span>
            {% endif %}
            <span class="brand-text">
              <span class="brand-name">{{ site.title | default: site.github.repository_name }}</span>
              <span class="brand-role">{{ site.description }}</span>
            </span>
          </a>

          <button class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">
            <span></span>
            <span></span>
            <span></span>
          </button>

          <nav class="site-nav" aria-label="Primary">
            <a href="{{ "/projects" | relative_url }}">Projects</a>
            <a href="{{ "/research" | relative_url }}">Research</a>
            <a href="{{ "/publications" | relative_url }}">Publications</a>
            <a href="{{ "/contact" | relative_url }}">Contact</a>
          </nav>

          <div class="header-actions">
            <a class="button ghost" href="{{ "/contact" | relative_url }}">Contact</a>
            <label class="theme-switch" for="theme-toggle">
              <input type="checkbox" id="theme-toggle" role="switch" aria-label="Switch to light theme" aria-checked="false">
              <span class="switch-track">
                <span class="switch-icon moon" aria-hidden="true">üåô</span>
                <span class="switch-icon sun" aria-hidden="true">‚òÄÔ∏è</span>
              </span>
              <span class="switch-status" data-theme-status aria-hidden="true">Dark</span>
              <span class="sr-only" data-theme-label>Dark theme active. Switch to light theme.</span>
            </label>
          </div>
        </div>
      </header>

      <main class="site-main">
        {{ content }}
      </main>

      <footer class="site-footer">
        <div class="container">
          <div class="footer-meta">
            <p>¬© {{ 'now' | date: "%Y" }} {{ site.title }} ¬∑ Crafted with curiosity</p>
            <p class="footer-tagline">Always exploring the playful side of serious AI.</p>
          </div>
          {% if site.sidebar %}
            <ul class="footer-social">
              {% for link in site.sidebar %}
                <li>
                  <a href="{{ link.link }}"{% if link.link contains 'http' %} target="_blank" rel="noopener"{% endif %}>
                    {{ link.icon }}<span>{{ link.name }}</span>
                  </a>
                </li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      </footer>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const themeToggle = document.getElementById('theme-toggle');
        const themeStatus = document.querySelector('[data-theme-status]');
        const themeLabel = document.querySelector('[data-theme-label]');
        const root = document.documentElement;
        const storedTheme = localStorage.getItem('theme') || root.getAttribute('data-theme') || 'dark';

        const setTheme = function(theme, persist) {
          const isLight = theme === 'light';
          root.setAttribute('data-theme', theme);
          if (persist) {
            localStorage.setItem('theme', theme);
          }
          if (themeToggle) {
            themeToggle.checked = isLight;
            themeToggle.setAttribute('aria-checked', isLight ? 'true' : 'false');
            themeToggle.setAttribute('aria-label', isLight ? 'Switch to dark theme' : 'Switch to light theme');
          }
          if (themeStatus) {
            themeStatus.textContent = isLight ? 'Light' : 'Dark';
          }
          if (themeLabel) {
            themeLabel.textContent = isLight
              ? 'Light theme active. Switch to dark theme.'
              : 'Dark theme active. Switch to light theme.';
          }
        };

        setTheme(storedTheme, false);

        if (themeToggle) {
          themeToggle.addEventListener('change', function() {
            const newTheme = this.checked ? 'light' : 'dark';
            setTheme(newTheme, true);
          });
        }

        const navToggle = document.querySelector('.nav-toggle');
        const nav = document.querySelector('.site-nav');
        if (navToggle && nav) {
          navToggle.addEventListener('click', function() {
            const isOpen = nav.classList.toggle('is-open');
            navToggle.setAttribute('aria-expanded', isOpen);
          });
          nav.querySelectorAll('a').forEach(function(link) {
            link.addEventListener('click', function() {
              nav.classList.remove('is-open');
              navToggle.setAttribute('aria-expanded', 'false');
            });
          });
        }
      });
    </script>
  </body>
</html>
